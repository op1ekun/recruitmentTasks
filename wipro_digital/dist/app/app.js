!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";n(1)},function(e,t,n){"use strict";function r(e){var t=e.params,n=e.response;(0,c.updateForecast)({params:t,response:{city:n.city,singleForecast:n.list[s]}})}var o=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(u){o=!0,a=u}finally{try{!r&&c["return"]&&c["return"]()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(2),i=n(5),c=n(6),u=void 0,s=0;i.appEventHandlers.onSearch=function(e,t){c.viewState.loading=!0,r(u);var n=e.split(","),i=o(n,2),l=i[0],d=i[1];(0,a.getForecast)(l,d,t).then(function(e){u=e,s=0,c.viewState.loading=!1,r(u)})},c.forecastEventHandlers.onNext=function(){s+1<u.response.list.length?(s++,c.viewState.next=!0,c.viewState.prev=!0):c.viewState.next=!1,r(u)},c.forecastEventHandlers.onPrev=function(){s-1>=0?(s--,c.viewState.next=!0,c.viewState.prev=!0):c.viewState.prev=!1,r(u)},(0,a.getForecast)().then(function(e){u=e,s=0,c.viewState.loading=!1,c.viewState.prev=!1,r(u)})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){return"http://api.openweathermap.org/data/2.5/forecast?q="+e+","+t+"&mode=json&appid="+c["default"].apiKey+"&units="+n}function a(){var e=arguments.length<=0||void 0===arguments[0]?"London":arguments[0],t=arguments.length<=1||void 0===arguments[1]?"":arguments[1],n=arguments.length<=2||void 0===arguments[2]?u.METRIC:arguments[2],r=o(e,t,n);return fetch(r,{method:"get"}).then(function(r){return r.json().then(function(r){return{response:r,params:{city:e,country:t,units:n}}})})["catch"](function(e){console.error(e)})}Object.defineProperty(t,"__esModule",{value:!0}),t.getForecast=a;var i=n(3),c=r(i),u=n(4)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={apiKey:"3f697675424c3d0afeafbe02610ce274"}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IMPERIAL="imperial",t.METRIC="metric"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appEventHandlers=void 0;var r=n(4),o=t.appEventHandlers={onSearch:null,onRefresh:null},a=document.querySelector("#searchText"),i=document.querySelector("#search"),c=document.querySelector("#units"),u=r.METRIC;c.addEventListener("click",function(e){var t=e.target.nodeName.toLowerCase();u="input"===t?e.target.value:e.target.control.value}),a.addEventListener("keypress",function(e){13===e.keyCode&&o.onSearch&&a.value&&(o.onSearch(a.value,u),a.value="")}),i.addEventListener("click",function(){o.onSearch&&a.value&&(o.onSearch(a.value,u),a.value="")})},function(e,t,n){"use strict";function r(e){var t=e.response,n=e.params,r=t.city,o=r.name,a=r.country,i=t.singleForecast,g=i.rain,M=i.main,w=i.clouds,x=i.dt,E=new Date(1e3*x),T=E.getUTCFullYear(),L=E.getUTCDate();L=10>L?"0"+L:L;var H=E.getUTCMonth()+1;H=10>H?"0"+H:H;var q=E.getUTCHours();q=10>q?"0"+q:q;var P=E.getUTCMinutes();P=10>P?"0"+P:P;var b=E.getUTCSeconds();b=10>b?"0"+b:b,s.innerHTML=o+", "+a,l.innerHTML=(g&&g["3h"]||0)+" mm",d.innerHTML=""+Math.round(M.temp)+(n.units===c.IMPERIAL?"&deg;F":"&deg;C"),v.innerHTML=Math.round(M.pressure)+" hPa",f.innerHTML=w.all+"%",p.innerHTML=L+"/"+H+"/"+T,m.innerHTML=q+":"+P+":"+b,y.disabled=!S.next,h.disabled=!S.prev,S.loading?u.className+=" loading":u.className=u.className.replace(/\sloading/,"")}function o(e){r(e)}function a(e){r(e)}function i(e){r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.forecastEventHandlers=t.viewState=void 0,t.updateForecast=o,t.getNextData=a,t.getPrevData=i;var c=n(4),u=document.querySelector(".forecast"),s=document.querySelector(".forecast .city"),l=document.querySelector(".rain > span"),d=document.querySelector(".temp > span"),v=document.querySelector(".pres > span"),f=document.querySelector(".clouds > span"),p=document.querySelector(".time > h2"),m=document.querySelector(".time > h3"),y=document.querySelector(".actions > .next"),h=document.querySelector(".actions > .prev"),S=t.viewState={next:!0,prev:!0,loading:!0},g=t.forecastEventHandlers={onNext:null,onPrev:null};y.addEventListener("click",function(){g.onNext&&g.onNext()}),h.addEventListener("click",function(){g.onPrev&&g.onPrev()})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vYXBwL2FwcC5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgZmY5YzQ4M2NmZjU0MmRhM2Q4NzAiLCJ3ZWJwYWNrOi8vLy4vYXBwL2FwcC5qcyIsIndlYnBhY2s6Ly8vLi9hcHAvYXBwLmNvbnRyb2xsZXJzLmpzIiwid2VicGFjazovLy8uL2FwcC9mb3JlY2FzdC9mb3JlY2FzdC5zZXJ2aWNlcy5qcyIsIndlYnBhY2s6Ly8vLi9hcHAvY29uZmlnLmpzIiwid2VicGFjazovLy8uL2FwcC9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vLy4vYXBwL2FwcC52aWV3cy5qcyIsIndlYnBhY2s6Ly8vLi9hcHAvZm9yZWNhc3QvZm9yZWNhc3Qudmlld3MuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwidXBkYXRlRm9yZWNhc3RWaWV3IiwiX3JlZiIsInBhcmFtcyIsInJlc3BvbnNlIiwiX2ZvcmVjYXN0Vmlld3MiLCJ1cGRhdGVGb3JlY2FzdCIsImNpdHkiLCJzaW5nbGVGb3JlY2FzdCIsImxpc3QiLCJjdXJyZW50Rm9yY2FzdEluZGV4IiwiX3NsaWNlZFRvQXJyYXkiLCJzbGljZUl0ZXJhdG9yIiwiYXJyIiwiaSIsIl9hcnIiLCJfbiIsIl9kIiwiX2UiLCJ1bmRlZmluZWQiLCJfcyIsIl9pIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJuZXh0IiwiZG9uZSIsInB1c2giLCJ2YWx1ZSIsImxlbmd0aCIsImVyciIsIkFycmF5IiwiaXNBcnJheSIsIk9iamVjdCIsIlR5cGVFcnJvciIsIl9mb3JlY2FzdFNlcnZpY2VzIiwiX2FwcFZpZXdzIiwiY3VycmVudERhdGEiLCJhcHBFdmVudEhhbmRsZXJzIiwib25TZWFyY2giLCJzZWFyY2hUZXh0IiwidW5pdHMiLCJ2aWV3U3RhdGUiLCJsb2FkaW5nIiwiX3NlYXJjaFRleHQkc3BsaXQiLCJzcGxpdCIsIl9zZWFyY2hUZXh0JHNwbGl0MiIsImNvdW50cnkiLCJnZXRGb3JlY2FzdCIsInRoZW4iLCJmb3JlY2FzdERhdGEiLCJmb3JlY2FzdEV2ZW50SGFuZGxlcnMiLCJvbk5leHQiLCJwcmV2Iiwib25QcmV2IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiZ2V0UXVlcnlVUkwiLCJfY29uZmlnMiIsImFwaUtleSIsImFyZ3VtZW50cyIsIl9jb25zdGFudHMiLCJNRVRSSUMiLCJxdWVyeVVSTCIsImZldGNoIiwibWV0aG9kIiwianNvbiIsInBhcnNlZERhdGEiLCJjb25zb2xlIiwiZXJyb3IiLCJkZWZpbmVQcm9wZXJ0eSIsIl9jb25maWciLCJJTVBFUklBTCIsIm9uUmVmcmVzaCIsInNlYXJjaFRleHRJbnB1dCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInNlYXJjaEJ1dHRvbiIsInVuaXRzQ250IiwidW5pdHNGb3JtYXQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXYiLCJub2RlTmFtZSIsInRhcmdldCIsInRvTG93ZXJDYXNlIiwiY29udHJvbCIsImtleUNvZGUiLCJyZW5kZXIiLCJfcmVzcG9uc2UkY2l0eSIsIm5hbWUiLCJfcmVzcG9uc2Ukc2luZ2xlRm9yZWMiLCJyYWluIiwibWFpbiIsImNsb3VkcyIsImR0IiwiZGF0ZSIsIkRhdGUiLCJ5ZWFyIiwiZ2V0VVRDRnVsbFllYXIiLCJkYXkiLCJnZXRVVENEYXRlIiwibW9udGgiLCJnZXRVVENNb250aCIsImhvdXJzIiwiZ2V0VVRDSG91cnMiLCJtaW51dGVzIiwiZ2V0VVRDTWludXRlcyIsInNlY29uZHMiLCJnZXRVVENTZWNvbmRzIiwiY2l0eUNudCIsImlubmVySFRNTCIsInJhaW5DbnQiLCJ0ZW1wQ250IiwiTWF0aCIsInJvdW5kIiwidGVtcCIsInByZXNDbnQiLCJwcmVzc3VyZSIsImNsb3Vkc0NudCIsImFsbCIsImRhdGVDbnQiLCJ0aW1lQ250IiwibmV4dEJ1dHRvbiIsImRpc2FibGVkIiwicHJldkJ1dHRvbiIsImZvcmVjYXN0Q250IiwiY2xhc3NOYW1lIiwicmVwbGFjZSIsImdldE5leHREYXRhIiwibmV4dERhdGEiLCJnZXRQcmV2RGF0YSIsInByZXZEYXRhIl0sIm1hcHBpbmdzIjoiQ0FBUyxTQUFVQSxHQ0luQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQUUsT0FHQSxJQUFBQyxHQUFBRixFQUFBRCxJQUNBRSxXQUNBRSxHQUFBSixFQUNBSyxRQUFBLEVBVUEsT0FOQVAsR0FBQUUsR0FBQU0sS0FBQUgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUgsR0FHQUksRUFBQUUsUUFBQSxFQUdBRixFQUFBRCxRQXZCQSxHQUFBRCxLQXFDQSxPQVRBRixHQUFBUSxFQUFBVCxFQUdBQyxFQUFBUyxFQUFBUCxFQUdBRixFQUFBVSxFQUFBLEdBR0FWLEVBQUEsS0RNTSxTQUFTSSxFQUFRRCxFQUFTSCxHQUUvQixZRTdDREEsR0FBQSxJRm1ETSxTQUFTSSxFQUFRRCxFQUFTSCxHQUUvQixZR3ZDRCxTQUFTVyxHQUFUQyxHSCtESyxHRy9Ed0JDLEdBQUFELEVBQUFDLE9BQVFDLEVBQUFGLEVBQUFFLFVBR2pDLEVBQUFDLEVBQUFDLGlCQUNJSCxPQUFRQSxFQUNSQyxVQUNJRyxLQUFNSCxFQUFTRyxLQUNmQyxlQUFnQkosRUFBU0ssS0FBS0MsTUhrQ3pDLEdBQUlDLEdBQWlCLFdBQWMsUUFBU0MsR0FBY0MsRUFBS0MsR0FBSyxHQUFJQyxNQUFlQyxHQUFLLEVBQVVDLEdBQUssRUFBV0MsRUFBS0MsTUFBVyxLQUFNLElBQUssR0FBaUNDLEdBQTdCQyxFQUFLUixFQUFJUyxPQUFPQyxjQUFtQlAsR0FBTUksRUFBS0MsRUFBR0csUUFBUUMsUUFBb0JWLEVBQUtXLEtBQUtOLEVBQUdPLFFBQVliLEdBQUtDLEVBQUthLFNBQVdkLEdBQTNERSxHQUFLLElBQW9FLE1BQU9hLEdB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RWhDWCxFQUFVQyxRQUNOb0YsRUFBWUMsV0FBYSxXQUN6QkQsRUFBWUMsVUFBWUQsRUFBWUMsVUFBVUMsUUFBUSxZQUFhLElBUXBFLFFBQVMxSCxHQUFlMkMsR0FFM0J1QyxFQUFPdkMsR0FRSixRQUFTZ0YsR0FBWUMsR0FFeEIxQyxFQUFPMEMsR0FRSixRQUFTQyxHQUFZQyxHQUV4QjVDLEVBQU80QyxHUm9QVnBHLE9BQU91QyxlQUFlOUUsRUFBUyxjQUMzQmtDLE9BQU8sSUFFWGxDLEVBQVF5RCxzQkFBd0J6RCxFQUFRZ0QsVUFBWXRCLE9BQ3BEMUIsRVE5UWVhLGlCUitRZmIsRVFyUWV3SSxjUnNRZnhJLEVRNVBlMEksYUF0R2hCLElBQUFyRSxHQUFBeEUsRUFBQSxHQUVNd0ksRUFBY2xELFNBQVNDLGNBQWMsYUFDckNpQyxFQUFVbEMsU0FBU0MsY0FBYyxtQkFDakNtQyxFQUFVcEMsU0FBU0MsY0FBYyxnQkFDakNvQyxFQUFVckMsU0FBU0MsY0FBYyxnQkFDakN3QyxFQUFVekMsU0FBU0MsY0FBYyxnQkFDakMwQyxFQUFZM0MsU0FBU0MsY0FBYyxrQkFDbkM0QyxFQUFVN0MsU0FBU0MsY0FBYyxjQUNqQzZDLEVBQVU5QyxTQUFTQyxjQUFjLGNBQ2pDOEMsRUFBYS9DLFNBQVNDLGNBQWMsb0JBQ3BDZ0QsRUFBYWpELFNBQVNDLGNBQWMsb0JBRS9CcEMsRUFBQWhELEVBQUFnRCxXQUNQakIsTUFBTSxFQUNONEIsTUFBTSxFQUNOVixTQUFTLEdBR0ZRLEVBQUF6RCxFQUFBeUQsdUJBQ1BDLE9BQVEsS0FDUkUsT0FBUSxLQXNGWnNFLEdBQVcxQyxpQkFBaUIsUUFBUyxXQUk3Qi9CLEVBQXNCQyxRQUN0QkQsRUFBc0JDLFdBSTlCMEUsRUFBVzVDLGlCQUFpQixRQUFTLFdBSTdCL0IsRUFBc0JHLFFBQ3RCSCxFQUFzQkciLCJmaWxlIjoiYXBwL2FwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0X193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblxuLyoqKi8gfSxcbi8qIDEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBfc2xpY2VkVG9BcnJheSA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gc2xpY2VJdGVyYXRvcihhcnIsIGkpIHsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbXCJyZXR1cm5cIl0pIF9pW1wicmV0dXJuXCJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfSByZXR1cm4gZnVuY3Rpb24gKGFyciwgaSkgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IHJldHVybiBhcnI7IH0gZWxzZSBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChhcnIpKSB7IHJldHVybiBzbGljZUl0ZXJhdG9yKGFyciwgaSk7IH0gZWxzZSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlXCIpOyB9IH07IH0oKTtcblx0XG5cdHZhciBfZm9yZWNhc3RTZXJ2aWNlcyA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdFxuXHR2YXIgX2FwcFZpZXdzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcblx0XG5cdHZhciBfZm9yZWNhc3RWaWV3cyA9IF9fd2VicGFja19yZXF1aXJlX18oNik7XG5cdFxuXHQvLyBob2xkcyBjdXJyZW50IGZvcmVjYXN0IGRhdGEgZm9ybSBBUElcblx0dmFyIGN1cnJlbnREYXRhID0gdm9pZCAwO1xuXHQvLyB0aGUgaW5kZXggb2YgdGhlIGN1cnJlbnQgKHNpbmdsZSkgZm9yZWNhc3Rcblx0dmFyIGN1cnJlbnRGb3JjYXN0SW5kZXggPSAwO1xuXHRcblx0LyoqXHJcblx0ICogUHJlcGFyZXMgZGF0YSBmb3IgdGhlIHZpZXcsIGFuZCBhbmQgdXBkYXRlcyBpdC5cclxuXHQgKiBcclxuXHQgKiBAcGFyYW0gIHtPYmplY3R9IGZvcmVjYXN0RGF0YSAgICBiZXNwb2tlIGRhdGEgb2JqZWN0IGNvbnRhaW5pbmcgYm90aCB0aGUgb3JpZ2luYWwgcmVzcG9uc2UgYW5kIHF1ZXJ5IHBhcmFtc1xyXG5cdCAqIEByZXR1cm4ge3VuZGVmaW5lZH1cclxuXHQgKi9cblx0ZnVuY3Rpb24gdXBkYXRlRm9yZWNhc3RWaWV3KF9yZWYpIHtcblx0ICAgICd1c2Ugc3RyaWN0Jztcblx0XG5cdCAgICB2YXIgcGFyYW1zID0gX3JlZi5wYXJhbXM7XG5cdCAgICB2YXIgcmVzcG9uc2UgPSBfcmVmLnJlc3BvbnNlO1xuXHQgICAgKDAsIF9mb3JlY2FzdFZpZXdzLnVwZGF0ZUZvcmVjYXN0KSh7XG5cdCAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG5cdCAgICAgICAgcmVzcG9uc2U6IHtcblx0ICAgICAgICAgICAgY2l0eTogcmVzcG9uc2UuY2l0eSxcblx0ICAgICAgICAgICAgc2luZ2xlRm9yZWNhc3Q6IHJlc3BvbnNlLmxpc3RbY3VycmVudEZvcmNhc3RJbmRleF1cblx0ICAgICAgICB9XG5cdCAgICB9KTtcblx0fVxuXHRcblx0LyoqXHJcblx0ICogQSBoYW5kbGVyIGZvciB0aGUgb24gc2VhcmNoIGV2ZW50LlxyXG5cdCAqIENhbGxzIHNlcnZpY2UgbWV0aG9kIHRvIGdldCBmb3JlY2FzdCBkYXRhIGZyb20gQVBJLlxyXG5cdCAqIFxyXG5cdCAqIEBwYXJhbSAge1N0cmluZ30gc2VhcmNoVGV4dCAgdGhlIHRleHQgdGhhdCB1c2VyIGVudGVyZWQgaW4gdGhlIHNlYXJjaCBib3hcclxuXHQgKiBAcGFyYW0gIHtTdHJpbmd9IHVuaXRzICAgICAgIGVpdGhlciAnbWV0cmljJyBvciAnaW1wZXJpYWwnXHJcblx0ICogQHJldHVybiB7dW5kZWZpbmVkfVxyXG5cdCAqL1xuXHRfYXBwVmlld3MuYXBwRXZlbnRIYW5kbGVycy5vblNlYXJjaCA9IGZ1bmN0aW9uIChzZWFyY2hUZXh0LCB1bml0cykge1xuXHQgICAgJ3VzZSBzdHJpY3QnO1xuXHRcblx0ICAgIF9mb3JlY2FzdFZpZXdzLnZpZXdTdGF0ZS5sb2FkaW5nID0gdHJ1ZTtcblx0ICAgIHVwZGF0ZUZvcmVjYXN0VmlldyhjdXJyZW50RGF0YSk7XG5cdFxuXHQgICAgdmFyIF9zZWFyY2hUZXh0JHNwbGl0ID0gc2VhcmNoVGV4dC5zcGxpdCgnLCcpO1xuXHRcblx0ICAgIHZhciBfc2VhcmNoVGV4dCRzcGxpdDIgPSBfc2xpY2VkVG9BcnJheShfc2VhcmNoVGV4dCRzcGxpdCwgMik7XG5cdFxuXHQgICAgdmFyIGNpdHkgPSBfc2VhcmNoVGV4dCRzcGxpdDJbMF07XG5cdCAgICB2YXIgY291bnRyeSA9IF9zZWFyY2hUZXh0JHNwbGl0MlsxXTtcblx0XG5cdFxuXHQgICAgKDAsIF9mb3JlY2FzdFNlcnZpY2VzLmdldEZvcmVjYXN0KShjaXR5LCBjb3VudHJ5LCB1bml0cykudGhlbihmdW5jdGlvbiAoZm9yZWNhc3REYXRhKSB7XG5cdCAgICAgICAgLy8gcmVmcmVzaCBkYXRhXG5cdCAgICAgICAgY3VycmVudERhdGEgPSBmb3JlY2FzdERhdGE7XG5cdCAgICAgICAgLy8gcmVzZXQgaW5kZXhcblx0ICAgICAgICBjdXJyZW50Rm9yY2FzdEluZGV4ID0gMDtcblx0ICAgICAgICBfZm9yZWNhc3RWaWV3cy52aWV3U3RhdGUubG9hZGluZyA9IGZhbHNlO1xuXHQgICAgICAgIHVwZGF0ZUZvcmVjYXN0VmlldyhjdXJyZW50RGF0YSk7XG5cdCAgICB9KTtcblx0fTtcblx0XG5cdC8qKlxyXG5cdCAqIEEgaGFuZGxlciBmb3IgdGhlIG9uIG5leHQgZXZlbnQuXHJcblx0ICogVXBkYXRlcyBmaXJlY3QgdmlldyBpZiB1cGRhdGUgaXMgYXZhaWxhYmxlLlxyXG5cdCAqIFxyXG5cdCAqIEByZXR1cm4ge3VuZGVmaW5lZH1cclxuXHQgKi9cblx0X2ZvcmVjYXN0Vmlld3MuZm9yZWNhc3RFdmVudEhhbmRsZXJzLm9uTmV4dCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICd1c2Ugc3RyaWN0Jztcblx0XG5cdCAgICBpZiAoY3VycmVudEZvcmNhc3RJbmRleCArIDEgPCBjdXJyZW50RGF0YS5yZXNwb25zZS5saXN0Lmxlbmd0aCkge1xuXHQgICAgICAgIGN1cnJlbnRGb3JjYXN0SW5kZXgrKztcblx0ICAgICAgICBfZm9yZWNhc3RWaWV3cy52aWV3U3RhdGUubmV4dCA9IHRydWU7XG5cdCAgICAgICAgX2ZvcmVjYXN0Vmlld3Mudmlld1N0YXRlLnByZXYgPSB0cnVlO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgICBfZm9yZWNhc3RWaWV3cy52aWV3U3RhdGUubmV4dCA9IGZhbHNlO1xuXHQgICAgfVxuXHRcblx0ICAgIHVwZGF0ZUZvcmVjYXN0VmlldyhjdXJyZW50RGF0YSk7XG5cdH07XG5cdFxuXHQvKipcclxuXHQgKiBBIGhhbmRsZXIgZm9yIHRoZSBvbiBwcmV2IGV2ZW50LlxyXG5cdCAqIFVwZGF0ZXMgZmlyZWN0IHZpZXcgaWYgdXBkYXRlIGlzIGF2YWlsYWJsZS5cclxuXHQgKiBcclxuXHQgKiBAcmV0dXJuIHt1bmRlZmluZWR9XHJcblx0ICovXG5cdF9mb3JlY2FzdFZpZXdzLmZvcmVjYXN0RXZlbnRIYW5kbGVycy5vblByZXYgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAndXNlIHN0cmljdCc7XG5cdFxuXHQgICAgaWYgKGN1cnJlbnRGb3JjYXN0SW5kZXggLSAxID49IDApIHtcblx0ICAgICAgICBjdXJyZW50Rm9yY2FzdEluZGV4LS07XG5cdCAgICAgICAgX2ZvcmVjYXN0Vmlld3Mudmlld1N0YXRlLm5leHQgPSB0cnVlO1xuXHQgICAgICAgIF9mb3JlY2FzdFZpZXdzLnZpZXdTdGF0ZS5wcmV2ID0gdHJ1ZTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgICAgX2ZvcmVjYXN0Vmlld3Mudmlld1N0YXRlLnByZXYgPSBmYWxzZTtcblx0ICAgIH1cblx0XG5cdCAgICB1cGRhdGVGb3JlY2FzdFZpZXcoY3VycmVudERhdGEpO1xuXHR9O1xuXHRcblx0Ly8gaW5pdFxuXHQoMCwgX2ZvcmVjYXN0U2VydmljZXMuZ2V0Rm9yZWNhc3QpKCkudGhlbihmdW5jdGlvbiAoZm9yZWNhc3REYXRhKSB7XG5cdCAgICAndXNlIHN0cmljdCc7XG5cdFxuXHQgICAgLy8gcmVmcmVzaCBkYXRhXG5cdFxuXHQgICAgY3VycmVudERhdGEgPSBmb3JlY2FzdERhdGE7XG5cdCAgICAvLyByZXNldCBpbmRleFxuXHQgICAgY3VycmVudEZvcmNhc3RJbmRleCA9IDA7XG5cdFxuXHQgICAgX2ZvcmVjYXN0Vmlld3Mudmlld1N0YXRlLmxvYWRpbmcgPSBmYWxzZTtcblx0ICAgIF9mb3JlY2FzdFZpZXdzLnZpZXdTdGF0ZS5wcmV2ID0gZmFsc2U7XG5cdCAgICB1cGRhdGVGb3JlY2FzdFZpZXcoY3VycmVudERhdGEpO1xuXHR9KTtcblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdGV4cG9ydHMuZ2V0Rm9yZWNhc3QgPSBnZXRGb3JlY2FzdDtcblx0XG5cdHZhciBfY29uZmlnID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcblx0XG5cdHZhciBfY29uZmlnMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbmZpZyk7XG5cdFxuXHR2YXIgX2NvbnN0YW50cyA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0LyoqXHJcblx0ICogUGFyc2UgYW5kIHJldHVybiBhbiBBUEkgcXVlcnkgVVJMLlxyXG5cdCAqIFxyXG5cdCAqIEBwYXJhbSAge1N0cmluZ30gY2l0eSAgICB0aGUgbmFtZSBvZiBhIGNpdHlcclxuXHQgKiBAcGFyYW0gIHtTdHJpbmd9IGNvdW50cnkgdGhlIG5hbWUgb2YgYSBjb3VudHJ5XHJcblx0ICogQHBhcmFtICB7U3RyaW5nfSB1bml0cyAgIHVuaXRzIGZvcm1hdCwgZWl0aGVyIG1ldHJpYyBvciBpbXBlcmlhbFxyXG5cdCAqIEByZXR1cm4ge1N0cmluZ30gICAgICAgICB0aGUgcGFyc2VkIHRlbXBsYXRlIHN0cmluZ1xyXG5cdCAqL1xuXHRmdW5jdGlvbiBnZXRRdWVyeVVSTChjaXR5LCBjb3VudHJ5LCB1bml0cykge1xuXHQgICAgJ3VzZSBzdHJpY3QnO1xuXHRcblx0ICAgIHJldHVybiAnaHR0cDovL2FwaS5vcGVud2VhdGhlcm1hcC5vcmcvZGF0YS8yLjUvZm9yZWNhc3Q/cT0nICsgY2l0eSArICcsJyArIGNvdW50cnkgKyAnJm1vZGU9anNvbiZhcHBpZD0nICsgX2NvbmZpZzIuZGVmYXVsdC5hcGlLZXkgKyAnJnVuaXRzPScgKyB1bml0cztcblx0fVxuXHRcblx0LyoqXHJcblx0ICogR2V0IGZvcmVjYXN0IGRhdGEgZnJvbSBhcGkgZm9yIGdpdmVuIGxvY2F0aW9uLlxyXG5cdCAqIFxyXG5cdCAqIEBwYXJhbSAge1N0cmluZ30gY2l0eSAgICB0aGUgbmFtZSBvZiBhIGNpdHksIGRlZmF1bHRzIHRvICdMb25kb24nXHJcblx0ICogQHBhcmFtICB7U3RyaW5nfSBjb3VudHJ5IHRoZSBuYW1lIG9mIGEgY291bnRyeSwgZGVmYXVsdHMgdG8gJydcclxuXHQgKiBAcGFyYW0gIHtTdHJpbmd9IHVuaXRzICAgdW5pdHMgZm9ybWF0LCBlaXRoZXIgbWV0cmljIG9yIGltcGVyaWFsLCBkZWZhdWx0cyB0byAnbWV0cmljJ1xyXG5cdCAqIEByZXR1cm4ge1Byb21pc2V9ICAgICAgICBhIFByb21pc2UgdGhhdCBldmVudHVhbGx5IHJldHVybnMgYSBjdXN0b20gb2JqZWN0IHdpdGggcmVzcG9uc2UsIGFuZCBxdWVyeSBwYXJhbWV0ZXJzIFxyXG5cdCAqL1xuXHRmdW5jdGlvbiBnZXRGb3JlY2FzdCgpIHtcblx0ICAgICd1c2Ugc3RyaWN0Jztcblx0XG5cdCAgICB2YXIgY2l0eSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/ICdMb25kb24nIDogYXJndW1lbnRzWzBdO1xuXHQgICAgdmFyIGNvdW50cnkgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyAnJyA6IGFyZ3VtZW50c1sxXTtcblx0ICAgIHZhciB1bml0cyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IF9jb25zdGFudHMuTUVUUklDIDogYXJndW1lbnRzWzJdO1xuXHQgICAgdmFyIHF1ZXJ5VVJMID0gZ2V0UXVlcnlVUkwoY2l0eSwgY291bnRyeSwgdW5pdHMpO1xuXHRcblx0ICAgIHJldHVybiBmZXRjaChxdWVyeVVSTCwge1xuXHQgICAgICAgIG1ldGhvZDogJ2dldCdcblx0ICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cdFxuXHQgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCkudGhlbihmdW5jdGlvbiAocGFyc2VkRGF0YSkge1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgICAgIC8vIG9yaWdpbmFsIHJlc3BvbnNlXG5cdCAgICAgICAgICAgICAgICByZXNwb25zZTogcGFyc2VkRGF0YSxcblx0ICAgICAgICAgICAgICAgIC8vIHF1ZXJ5IHBhcmFtcyBzZW50IHRvIEFQSVxuXHQgICAgICAgICAgICAgICAgcGFyYW1zOiB7XG5cdCAgICAgICAgICAgICAgICAgICAgY2l0eTogY2l0eSxcblx0ICAgICAgICAgICAgICAgICAgICBjb3VudHJ5OiBjb3VudHJ5LFxuXHQgICAgICAgICAgICAgICAgICAgIHVuaXRzOiB1bml0c1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgIH0pO1xuXHQgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuXHQgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcblx0ICAgIH0pO1xuXHR9XG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLmRlZmF1bHQgPSB7XG5cdCAgICBhcGlLZXk6ICczZjY5NzY3NTQyNGMzZDBhZmVhZmJlMDI2MTBjZTI3NCdcblx0fTtcblxuLyoqKi8gfSxcbi8qIDQgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHR2YXIgSU1QRVJJQUwgPSBleHBvcnRzLklNUEVSSUFMID0gJ2ltcGVyaWFsJztcblx0dmFyIE1FVFJJQyA9IGV4cG9ydHMuTUVUUklDID0gJ21ldHJpYyc7XG5cbi8qKiovIH0sXG4vKiA1ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLmFwcEV2ZW50SGFuZGxlcnMgPSB1bmRlZmluZWQ7XG5cdFxuXHR2YXIgX2NvbnN0YW50cyA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7XG5cdFxuXHR2YXIgYXBwRXZlbnRIYW5kbGVycyA9IGV4cG9ydHMuYXBwRXZlbnRIYW5kbGVycyA9IHtcblx0ICAgIG9uU2VhcmNoOiBudWxsLFxuXHQgICAgb25SZWZyZXNoOiBudWxsXG5cdH07XG5cdFxuXHR2YXIgc2VhcmNoVGV4dElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlYXJjaFRleHQnKTtcblx0dmFyIHNlYXJjaEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWFyY2gnKTtcblx0dmFyIHVuaXRzQ250ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3VuaXRzJyk7XG5cdFxuXHQvLyBkZWZhdWx0XG5cdHZhciB1bml0c0Zvcm1hdCA9IF9jb25zdGFudHMuTUVUUklDO1xuXHRcblx0Ly8gYSBiaXQgb2YgZXZlbnQgZGVsZWdhdGlvblxuXHR1bml0c0NudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldikge1xuXHQgICAgJ3VzZSBzdHJpY3QnO1xuXHRcblx0ICAgIHZhciBub2RlTmFtZSA9IGV2LnRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuXHRcblx0ICAgIGlmIChub2RlTmFtZSA9PT0gJ2lucHV0Jykge1xuXHQgICAgICAgIHVuaXRzRm9ybWF0ID0gZXYudGFyZ2V0LnZhbHVlO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgICB1bml0c0Zvcm1hdCA9IGV2LnRhcmdldC5jb250cm9sLnZhbHVlO1xuXHQgICAgfVxuXHR9KTtcblx0XG5cdC8vIGxpc3RlbnMgZm9yIHVzZXIncyBrZXByZXNzZXMsIGFuZCBwYXNzZXMgZGF0YSB0byBjb250cm9sbGVyXG5cdHNlYXJjaFRleHRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIGZ1bmN0aW9uIChldikge1xuXHQgICAgJ3VzZSBzdHJpY3QnO1xuXHRcblx0ICAgIC8vIG9ubHkgb24gZW50ZXJcblx0XG5cdCAgICBpZiAoZXYua2V5Q29kZSA9PT0gMTMpIHtcblx0XG5cdCAgICAgICAgLy8gaWYgY2FsbGJhY2sgaXMgY29uZmlndXJlZFxuXHQgICAgICAgIGlmIChhcHBFdmVudEhhbmRsZXJzLm9uU2VhcmNoICYmIHNlYXJjaFRleHRJbnB1dC52YWx1ZSkge1xuXHQgICAgICAgICAgICBhcHBFdmVudEhhbmRsZXJzLm9uU2VhcmNoKHNlYXJjaFRleHRJbnB1dC52YWx1ZSwgdW5pdHNGb3JtYXQpO1xuXHRcblx0ICAgICAgICAgICAgLy8gcmVzZXQgdGhlIHNlYXJjaCBpbnB1dFxuXHQgICAgICAgICAgICBzZWFyY2hUZXh0SW5wdXQudmFsdWUgPSAnJztcblx0ICAgICAgICB9XG5cdCAgICB9XG5cdH0pO1xuXHRcblx0Ly8gbGlzdGVucyBmb3IgdXNlcidzIGNsaWNrcywgYW5kIHBhc3NlcyBkYXRhIHRvIGNvbnRyb2xsZXJcblx0c2VhcmNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXHQgICAgJ3VzZSBzdHJpY3QnO1xuXHRcblx0ICAgIC8vIGlmIGNhbGxiYWNrIGlzIGNvbmZpZ3VyZWRcblx0XG5cdCAgICBpZiAoYXBwRXZlbnRIYW5kbGVycy5vblNlYXJjaCAmJiBzZWFyY2hUZXh0SW5wdXQudmFsdWUpIHtcblx0ICAgICAgICBhcHBFdmVudEhhbmRsZXJzLm9uU2VhcmNoKHNlYXJjaFRleHRJbnB1dC52YWx1ZSwgdW5pdHNGb3JtYXQpO1xuXHRcblx0ICAgICAgICAvLyByZXNldCB0aGUgc2VhcmNoIGlucHV0XG5cdCAgICAgICAgc2VhcmNoVGV4dElucHV0LnZhbHVlID0gJyc7XG5cdCAgICB9XG5cdH0pO1xuXG4vKioqLyB9LFxuLyogNiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0ZXhwb3J0cy5mb3JlY2FzdEV2ZW50SGFuZGxlcnMgPSBleHBvcnRzLnZpZXdTdGF0ZSA9IHVuZGVmaW5lZDtcblx0ZXhwb3J0cy51cGRhdGVGb3JlY2FzdCA9IHVwZGF0ZUZvcmVjYXN0O1xuXHRleHBvcnRzLmdldE5leHREYXRhID0gZ2V0TmV4dERhdGE7XG5cdGV4cG9ydHMuZ2V0UHJldkRhdGEgPSBnZXRQcmV2RGF0YTtcblx0XG5cdHZhciBfY29uc3RhbnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcblx0XG5cdHZhciBmb3JlY2FzdENudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JlY2FzdCcpO1xuXHR2YXIgY2l0eUNudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JlY2FzdCAuY2l0eScpO1xuXHR2YXIgcmFpbkNudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yYWluID4gc3BhbicpO1xuXHR2YXIgdGVtcENudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZW1wID4gc3BhbicpO1xuXHR2YXIgcHJlc0NudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmVzID4gc3BhbicpO1xuXHR2YXIgY2xvdWRzQ250ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsb3VkcyA+IHNwYW4nKTtcblx0dmFyIGRhdGVDbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGltZSA+IGgyJyk7XG5cdHZhciB0aW1lQ250ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRpbWUgPiBoMycpO1xuXHR2YXIgbmV4dEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hY3Rpb25zID4gLm5leHQnKTtcblx0dmFyIHByZXZCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWN0aW9ucyA+IC5wcmV2Jyk7XG5cdFxuXHR2YXIgdmlld1N0YXRlID0gZXhwb3J0cy52aWV3U3RhdGUgPSB7XG5cdCAgICBuZXh0OiB0cnVlLFxuXHQgICAgcHJldjogdHJ1ZSxcblx0ICAgIGxvYWRpbmc6IHRydWVcblx0fTtcblx0XG5cdHZhciBmb3JlY2FzdEV2ZW50SGFuZGxlcnMgPSBleHBvcnRzLmZvcmVjYXN0RXZlbnRIYW5kbGVycyA9IHtcblx0ICAgIG9uTmV4dDogbnVsbCxcblx0ICAgIG9uUHJldjogbnVsbFxuXHR9O1xuXHRcblx0LyoqXHJcblx0ICogUmVuZGVycyB2YWx1c2UgaW50byB0aGUgaHRtbCB1c2luZyBodG1sIHRlbXBsYXRlIHN0cmluZ3MuXHJcblx0ICogXHJcblx0ICogQHBhcmFtICB7T2JqZWN0fSBvcHRpb25zLnJlc3BvbnNlICAgIHRoZSByZXNwb25zZSBvYmplY3QgZm9yIGEgc2luZ2xlIGZvcmVjYXN0XHJcblx0ICogQHBhcmFtICB7T2JqZWN0fSBvcHRpb25zLnBhcmFtcyAgICAgIHRoZWUgcXVlcnkgcGFyYW1ldGVyc1xyXG5cdCAqIEByZXR1cm4ge3VuZGVmaW5lZH1cclxuXHQgKi9cblx0ZnVuY3Rpb24gcmVuZGVyKF9yZWYpIHtcblx0ICAgICd1c2Ugc3RyaWN0Jztcblx0XG5cdCAgICB2YXIgcmVzcG9uc2UgPSBfcmVmLnJlc3BvbnNlO1xuXHQgICAgdmFyIHBhcmFtcyA9IF9yZWYucGFyYW1zO1xuXHQgICAgdmFyIF9yZXNwb25zZSRjaXR5ID0gcmVzcG9uc2UuY2l0eTtcblx0ICAgIHZhciBuYW1lID0gX3Jlc3BvbnNlJGNpdHkubmFtZTtcblx0ICAgIHZhciBjb3VudHJ5ID0gX3Jlc3BvbnNlJGNpdHkuY291bnRyeTtcblx0ICAgIHZhciBfcmVzcG9uc2Ukc2luZ2xlRm9yZWMgPSByZXNwb25zZS5zaW5nbGVGb3JlY2FzdDtcblx0ICAgIHZhciByYWluID0gX3Jlc3BvbnNlJHNpbmdsZUZvcmVjLnJhaW47XG5cdCAgICB2YXIgbWFpbiA9IF9yZXNwb25zZSRzaW5nbGVGb3JlYy5tYWluO1xuXHQgICAgdmFyIGNsb3VkcyA9IF9yZXNwb25zZSRzaW5nbGVGb3JlYy5jbG91ZHM7XG5cdCAgICB2YXIgZHQgPSBfcmVzcG9uc2Ukc2luZ2xlRm9yZWMuZHQ7XG5cdFxuXHQgICAgLy8gY29udmVydCBVTklYIHRpbWVzdGFtcCB0byBtaWxsaXNlY29uZHNcblx0XG5cdCAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKGR0ICogMTAwMCk7XG5cdCAgICB2YXIgeWVhciA9IGRhdGUuZ2V0VVRDRnVsbFllYXIoKTtcblx0XG5cdCAgICAvLyBwYXJzaW5nIGRhdGUgLSB1Z2hcblx0ICAgIHZhciBkYXkgPSBkYXRlLmdldFVUQ0RhdGUoKTtcblx0ICAgIGRheSA9IGRheSA8IDEwID8gJzAnICsgZGF5IDogZGF5O1xuXHRcblx0ICAgIHZhciBtb250aCA9IGRhdGUuZ2V0VVRDTW9udGgoKSArIDE7XG5cdCAgICBtb250aCA9IG1vbnRoIDwgMTAgPyAnMCcgKyBtb250aCA6IG1vbnRoO1xuXHRcblx0ICAgIHZhciBob3VycyA9IGRhdGUuZ2V0VVRDSG91cnMoKTtcblx0ICAgIGhvdXJzID0gaG91cnMgPCAxMCA/ICcwJyArIGhvdXJzIDogaG91cnM7XG5cdFxuXHQgICAgdmFyIG1pbnV0ZXMgPSBkYXRlLmdldFVUQ01pbnV0ZXMoKTtcblx0ICAgIG1pbnV0ZXMgPSBtaW51dGVzIDwgMTAgPyAnMCcgKyBtaW51dGVzIDogbWludXRlcztcblx0XG5cdCAgICB2YXIgc2Vjb25kcyA9IGRhdGUuZ2V0VVRDU2Vjb25kcygpO1xuXHQgICAgc2Vjb25kcyA9IHNlY29uZHMgPCAxMCA/ICcwJyArIHNlY29uZHMgOiBzZWNvbmRzO1xuXHRcblx0ICAgIC8vIG5vIG9wdGltaXplZFxuXHQgICAgLy8gVE9ETyBkaWZmIGNvbnRlbnQsIGFuZCBvbmx5IG92ZXJ3cml0ZSB3aGVyZSB0aGVyZSdzIGEgY2hhbmdlXG5cdCAgICBjaXR5Q250LmlubmVySFRNTCA9IG5hbWUgKyAnLCAnICsgY291bnRyeTtcblx0ICAgIHJhaW5DbnQuaW5uZXJIVE1MID0gKHJhaW4gJiYgcmFpblsnM2gnXSB8fCAwKSArICcgbW0nO1xuXHQgICAgdGVtcENudC5pbm5lckhUTUwgPSAnJyArIE1hdGgucm91bmQobWFpbi50ZW1wKSArIChwYXJhbXMudW5pdHMgPT09IF9jb25zdGFudHMuSU1QRVJJQUwgPyAnJmRlZztGJyA6ICcmZGVnO0MnKTtcblx0ICAgIHByZXNDbnQuaW5uZXJIVE1MID0gTWF0aC5yb3VuZChtYWluLnByZXNzdXJlKSArICcgaFBhJztcblx0ICAgIGNsb3Vkc0NudC5pbm5lckhUTUwgPSBjbG91ZHMuYWxsICsgJyUnO1xuXHQgICAgZGF0ZUNudC5pbm5lckhUTUwgPSBkYXkgKyAnLycgKyBtb250aCArICcvJyArIHllYXI7XG5cdCAgICB0aW1lQ250LmlubmVySFRNTCA9IGhvdXJzICsgJzonICsgbWludXRlcyArICc6JyArIHNlY29uZHM7XG5cdFxuXHQgICAgLy8gbm90IG9wdGltaXplZFxuXHQgICAgLy8gYWN0aW9ucyBhcyBhYm92ZVxuXHQgICAgbmV4dEJ1dHRvbi5kaXNhYmxlZCA9IHZpZXdTdGF0ZS5uZXh0ID8gZmFsc2UgOiB0cnVlO1xuXHQgICAgcHJldkJ1dHRvbi5kaXNhYmxlZCA9IHZpZXdTdGF0ZS5wcmV2ID8gZmFsc2UgOiB0cnVlO1xuXHRcblx0ICAgIHZpZXdTdGF0ZS5sb2FkaW5nID8gZm9yZWNhc3RDbnQuY2xhc3NOYW1lICs9ICcgbG9hZGluZycgOiBmb3JlY2FzdENudC5jbGFzc05hbWUgPSBmb3JlY2FzdENudC5jbGFzc05hbWUucmVwbGFjZSgvXFxzbG9hZGluZy8sICcnKTtcblx0fVxuXHRcblx0LyoqXHJcblx0ICogW3VwZGF0ZUZvcmVjYXN0IGRlc2NyaXB0aW9uXVxyXG5cdCAqIEBwYXJhbSAge1t0eXBlXX0gZm9yZWNhc3REYXRhIFtkZXNjcmlwdGlvbl1cclxuXHQgKiBAcmV0dXJuIHtbdHlwZV19ICAgICAgICAgICAgICBbZGVzY3JpcHRpb25dXHJcblx0ICovXG5cdGZ1bmN0aW9uIHVwZGF0ZUZvcmVjYXN0KGZvcmVjYXN0RGF0YSkge1xuXHQgICAgJ3VzZSBzdHJpY3QnO1xuXHRcblx0ICAgIHJlbmRlcihmb3JlY2FzdERhdGEpO1xuXHR9XG5cdFxuXHQvKipcclxuXHQgKiBbZ2V0TmV4dERhdGEgZGVzY3JpcHRpb25dXHJcblx0ICogQHBhcmFtICB7W3R5cGVdfSBuZXh0RGF0YSBbZGVzY3JpcHRpb25dXHJcblx0ICogQHJldHVybiB7W3R5cGVdfSAgICAgICAgICBbZGVzY3JpcHRpb25dXHJcblx0ICovXG5cdGZ1bmN0aW9uIGdldE5leHREYXRhKG5leHREYXRhKSB7XG5cdCAgICAndXNlIHN0cmljdCc7XG5cdFxuXHQgICAgcmVuZGVyKG5leHREYXRhKTtcblx0fVxuXHRcblx0LyoqXHJcblx0ICogW2dldFByZXZEYXRhIGRlc2NyaXB0aW9uXVxyXG5cdCAqIEBwYXJhbSAge1t0eXBlXX0gcHJldkRhdGEgW2Rlc2NyaXB0aW9uXVxyXG5cdCAqIEByZXR1cm4ge1t0eXBlXX0gICAgICAgICAgW2Rlc2NyaXB0aW9uXVxyXG5cdCAqL1xuXHRmdW5jdGlvbiBnZXRQcmV2RGF0YShwcmV2RGF0YSkge1xuXHQgICAgJ3VzZSBzdHJpY3QnO1xuXHRcblx0ICAgIHJlbmRlcihwcmV2RGF0YSk7XG5cdH1cblx0XG5cdG5leHRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAndXNlIHN0cmljdCc7XG5cdFxuXHQgICAgLy8gaWYgY2FsbGJhY2sgaXMgY29uZmlndXJlZFxuXHRcblx0ICAgIGlmIChmb3JlY2FzdEV2ZW50SGFuZGxlcnMub25OZXh0KSB7XG5cdCAgICAgICAgZm9yZWNhc3RFdmVudEhhbmRsZXJzLm9uTmV4dCgpO1xuXHQgICAgfVxuXHR9KTtcblx0XG5cdHByZXZCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAndXNlIHN0cmljdCc7XG5cdFxuXHQgICAgLy8gaWYgY2FsbGJhY2sgaXMgY29uZmlndXJlZFxuXHRcblx0ICAgIGlmIChmb3JlY2FzdEV2ZW50SGFuZGxlcnMub25QcmV2KSB7XG5cdCAgICAgICAgZm9yZWNhc3RFdmVudEhhbmRsZXJzLm9uUHJldigpO1xuXHQgICAgfVxuXHR9KTtcblxuLyoqKi8gfVxuLyoqKioqKi8gXSk7XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogYXBwL2FwcC5qc1xuICoqLyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay9ib290c3RyYXAgZmY5YzQ4M2NmZjU0MmRhM2Q4NzBcbiAqKi8iLCIvLyBlbnRyeSBwb2ludFxyXG5pbXBvcnQgJy4vYXBwLmNvbnRyb2xsZXJzLmpzJztcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL2FwcC9hcHAuanNcbiAqKi8iLCJpbXBvcnQge2dldEZvcmVjYXN0fSBmcm9tICcuL2ZvcmVjYXN0L2ZvcmVjYXN0LnNlcnZpY2VzLmpzJztcclxuaW1wb3J0IHthcHBFdmVudEhhbmRsZXJzfSBmcm9tICcuL2FwcC52aWV3cy5qcyc7XHJcbmltcG9ydCB7dXBkYXRlRm9yZWNhc3QsIGZvcmVjYXN0RXZlbnRIYW5kbGVycywgdmlld1N0YXRlfSBmcm9tICcuL2ZvcmVjYXN0L2ZvcmVjYXN0LnZpZXdzLmpzJztcclxuXHJcbi8vIGhvbGRzIGN1cnJlbnQgZm9yZWNhc3QgZGF0YSBmb3JtIEFQSVxyXG5sZXQgY3VycmVudERhdGE7XHJcbi8vIHRoZSBpbmRleCBvZiB0aGUgY3VycmVudCAoc2luZ2xlKSBmb3JlY2FzdFxyXG5sZXQgY3VycmVudEZvcmNhc3RJbmRleCA9IDA7XHJcblxyXG4vKipcclxuICogUHJlcGFyZXMgZGF0YSBmb3IgdGhlIHZpZXcsIGFuZCBhbmQgdXBkYXRlcyBpdC5cclxuICogXHJcbiAqIEBwYXJhbSAge09iamVjdH0gZm9yZWNhc3REYXRhICAgIGJlc3Bva2UgZGF0YSBvYmplY3QgY29udGFpbmluZyBib3RoIHRoZSBvcmlnaW5hbCByZXNwb25zZSBhbmQgcXVlcnkgcGFyYW1zXHJcbiAqIEByZXR1cm4ge3VuZGVmaW5lZH1cclxuICovXHJcbmZ1bmN0aW9uIHVwZGF0ZUZvcmVjYXN0Vmlldyh7cGFyYW1zLCByZXNwb25zZX0pIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB1cGRhdGVGb3JlY2FzdCh7XHJcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXHJcbiAgICAgICAgcmVzcG9uc2U6IHtcclxuICAgICAgICAgICAgY2l0eTogcmVzcG9uc2UuY2l0eSxcclxuICAgICAgICAgICAgc2luZ2xlRm9yZWNhc3Q6IHJlc3BvbnNlLmxpc3RbY3VycmVudEZvcmNhc3RJbmRleF1cclxuICAgICAgICB9XHJcbiAgICB9KTsgICBcclxufVxyXG5cclxuLyoqXHJcbiAqIEEgaGFuZGxlciBmb3IgdGhlIG9uIHNlYXJjaCBldmVudC5cclxuICogQ2FsbHMgc2VydmljZSBtZXRob2QgdG8gZ2V0IGZvcmVjYXN0IGRhdGEgZnJvbSBBUEkuXHJcbiAqIFxyXG4gKiBAcGFyYW0gIHtTdHJpbmd9IHNlYXJjaFRleHQgIHRoZSB0ZXh0IHRoYXQgdXNlciBlbnRlcmVkIGluIHRoZSBzZWFyY2ggYm94XHJcbiAqIEBwYXJhbSAge1N0cmluZ30gdW5pdHMgICAgICAgZWl0aGVyICdtZXRyaWMnIG9yICdpbXBlcmlhbCdcclxuICogQHJldHVybiB7dW5kZWZpbmVkfVxyXG4gKi9cclxuYXBwRXZlbnRIYW5kbGVycy5vblNlYXJjaCA9IChzZWFyY2hUZXh0LCB1bml0cykgPT4ge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZpZXdTdGF0ZS5sb2FkaW5nID0gdHJ1ZTtcclxuICAgIHVwZGF0ZUZvcmVjYXN0VmlldyhjdXJyZW50RGF0YSk7XHJcblxyXG4gICAgbGV0IFtjaXR5LCBjb3VudHJ5XSA9IHNlYXJjaFRleHQuc3BsaXQoJywnKTtcclxuXHJcbiAgICBnZXRGb3JlY2FzdChjaXR5LCBjb3VudHJ5LCB1bml0cylcclxuICAgICAgICAudGhlbigoZm9yZWNhc3REYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIHJlZnJlc2ggZGF0YVxyXG4gICAgICAgICAgICBjdXJyZW50RGF0YSA9IGZvcmVjYXN0RGF0YTtcclxuICAgICAgICAgICAgLy8gcmVzZXQgaW5kZXhcclxuICAgICAgICAgICAgY3VycmVudEZvcmNhc3RJbmRleCA9IDA7XHJcbiAgICAgICAgICAgIHZpZXdTdGF0ZS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHVwZGF0ZUZvcmVjYXN0VmlldyhjdXJyZW50RGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbn07XHJcblxyXG4vKipcclxuICogQSBoYW5kbGVyIGZvciB0aGUgb24gbmV4dCBldmVudC5cclxuICogVXBkYXRlcyBmaXJlY3QgdmlldyBpZiB1cGRhdGUgaXMgYXZhaWxhYmxlLlxyXG4gKiBcclxuICogQHJldHVybiB7dW5kZWZpbmVkfVxyXG4gKi9cclxuZm9yZWNhc3RFdmVudEhhbmRsZXJzLm9uTmV4dCA9ICgpID0+IHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBpZiAoY3VycmVudEZvcmNhc3RJbmRleCArIDEgPCBjdXJyZW50RGF0YS5yZXNwb25zZS5saXN0Lmxlbmd0aCkge1xyXG4gICAgICAgIGN1cnJlbnRGb3JjYXN0SW5kZXgrKztcclxuICAgICAgICB2aWV3U3RhdGUubmV4dCA9IHRydWU7XHJcbiAgICAgICAgdmlld1N0YXRlLnByZXYgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdmlld1N0YXRlLm5leHQgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVGb3JlY2FzdFZpZXcoY3VycmVudERhdGEpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEEgaGFuZGxlciBmb3IgdGhlIG9uIHByZXYgZXZlbnQuXHJcbiAqIFVwZGF0ZXMgZmlyZWN0IHZpZXcgaWYgdXBkYXRlIGlzIGF2YWlsYWJsZS5cclxuICogXHJcbiAqIEByZXR1cm4ge3VuZGVmaW5lZH1cclxuICovXHJcbmZvcmVjYXN0RXZlbnRIYW5kbGVycy5vblByZXYgPSAoKSA9PiB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgaWYgKGN1cnJlbnRGb3JjYXN0SW5kZXggLSAxID49IDApIHtcclxuICAgICAgICBjdXJyZW50Rm9yY2FzdEluZGV4LS07XHJcbiAgICAgICAgdmlld1N0YXRlLm5leHQgPSB0cnVlO1xyXG4gICAgICAgIHZpZXdTdGF0ZS5wcmV2ID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHZpZXdTdGF0ZS5wcmV2ID0gZmFsc2U7XHJcbiAgICB9ICAgIFxyXG5cclxuICAgIHVwZGF0ZUZvcmVjYXN0VmlldyhjdXJyZW50RGF0YSk7XHJcbn07XHJcblxyXG4vLyBpbml0XHJcbmdldEZvcmVjYXN0KClcclxuICAgIC50aGVuKChmb3JlY2FzdERhdGEpID0+IHtcclxuICAgICAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgICAgIC8vIHJlZnJlc2ggZGF0YVxyXG4gICAgICAgIGN1cnJlbnREYXRhID0gZm9yZWNhc3REYXRhO1xyXG4gICAgICAgIC8vIHJlc2V0IGluZGV4XHJcbiAgICAgICAgY3VycmVudEZvcmNhc3RJbmRleCA9IDA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmlld1N0YXRlLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICB2aWV3U3RhdGUucHJldiA9IGZhbHNlO1xyXG4gICAgICAgIHVwZGF0ZUZvcmVjYXN0VmlldyhjdXJyZW50RGF0YSk7XHJcbiAgICB9KTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL2FwcC9hcHAuY29udHJvbGxlcnMuanNcbiAqKi8iLCJpbXBvcnQgY29uZmlnIGZyb20gJy4uL2NvbmZpZy5qcyc7XHJcbmltcG9ydCB7SU1QRVJJQUwsIE1FVFJJQ30gZnJvbSAnLi4vY29uc3RhbnRzLmpzJztcclxuXHJcbi8qKlxyXG4gKiBQYXJzZSBhbmQgcmV0dXJuIGFuIEFQSSBxdWVyeSBVUkwuXHJcbiAqIFxyXG4gKiBAcGFyYW0gIHtTdHJpbmd9IGNpdHkgICAgdGhlIG5hbWUgb2YgYSBjaXR5XHJcbiAqIEBwYXJhbSAge1N0cmluZ30gY291bnRyeSB0aGUgbmFtZSBvZiBhIGNvdW50cnlcclxuICogQHBhcmFtICB7U3RyaW5nfSB1bml0cyAgIHVuaXRzIGZvcm1hdCwgZWl0aGVyIG1ldHJpYyBvciBpbXBlcmlhbFxyXG4gKiBAcmV0dXJuIHtTdHJpbmd9ICAgICAgICAgdGhlIHBhcnNlZCB0ZW1wbGF0ZSBzdHJpbmdcclxuICovXHJcbmZ1bmN0aW9uIGdldFF1ZXJ5VVJMKGNpdHksIGNvdW50cnksIHVuaXRzKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgcmV0dXJuIGBodHRwOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9kYXRhLzIuNS9mb3JlY2FzdD9xPSR7Y2l0eX0sJHtjb3VudHJ5fSZtb2RlPWpzb24mYXBwaWQ9JHtjb25maWcuYXBpS2V5fSZ1bml0cz0ke3VuaXRzfWA7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgZm9yZWNhc3QgZGF0YSBmcm9tIGFwaSBmb3IgZ2l2ZW4gbG9jYXRpb24uXHJcbiAqIFxyXG4gKiBAcGFyYW0gIHtTdHJpbmd9IGNpdHkgICAgdGhlIG5hbWUgb2YgYSBjaXR5LCBkZWZhdWx0cyB0byAnTG9uZG9uJ1xyXG4gKiBAcGFyYW0gIHtTdHJpbmd9IGNvdW50cnkgdGhlIG5hbWUgb2YgYSBjb3VudHJ5LCBkZWZhdWx0cyB0byAnJ1xyXG4gKiBAcGFyYW0gIHtTdHJpbmd9IHVuaXRzICAgdW5pdHMgZm9ybWF0LCBlaXRoZXIgbWV0cmljIG9yIGltcGVyaWFsLCBkZWZhdWx0cyB0byAnbWV0cmljJ1xyXG4gKiBAcmV0dXJuIHtQcm9taXNlfSAgICAgICAgYSBQcm9taXNlIHRoYXQgZXZlbnR1YWxseSByZXR1cm5zIGEgY3VzdG9tIG9iamVjdCB3aXRoIHJlc3BvbnNlLCBhbmQgcXVlcnkgcGFyYW1ldGVycyBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRGb3JlY2FzdChjaXR5ID0gJ0xvbmRvbicsIGNvdW50cnkgPSAnJywgdW5pdHMgPSBNRVRSSUMpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBjb25zdCBxdWVyeVVSTCA9IGdldFF1ZXJ5VVJMKGNpdHksIGNvdW50cnksIHVuaXRzKTtcclxuXHJcbiAgICByZXR1cm4gZmV0Y2gocXVlcnlVUkwsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnZ2V0J1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHBhcnNlZERhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3JpZ2luYWwgcmVzcG9uc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2U6IHBhcnNlZERhdGEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHF1ZXJ5IHBhcmFtcyBzZW50IHRvIEFQSVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpdHk6IGNpdHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5OiBjb3VudHJ5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdHM6IHVuaXRzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgICB9KTtcclxufVxyXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL2FwcC9mb3JlY2FzdC9mb3JlY2FzdC5zZXJ2aWNlcy5qc1xuICoqLyIsImV4cG9ydCBkZWZhdWx0IHtcclxuICAgIGFwaUtleTogJzNmNjk3Njc1NDI0YzNkMGFmZWFmYmUwMjYxMGNlMjc0J1xyXG59O1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vYXBwL2NvbmZpZy5qc1xuICoqLyIsImV4cG9ydCBjb25zdCBJTVBFUklBTCA9ICdpbXBlcmlhbCc7XHJcbmV4cG9ydCBjb25zdCBNRVRSSUMgPSAnbWV0cmljJztcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL2FwcC9jb25zdGFudHMuanNcbiAqKi8iLCJpbXBvcnQge01FVFJJQ30gZnJvbSAnLi9jb25zdGFudHMuanMnO1xyXG5cclxuZXhwb3J0IGxldCBhcHBFdmVudEhhbmRsZXJzID0ge1xyXG4gICAgb25TZWFyY2g6IG51bGwsXHJcbiAgICBvblJlZnJlc2g6IG51bGxcclxufTtcclxuXHJcbmNvbnN0IHNlYXJjaFRleHRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWFyY2hUZXh0Jyk7XHJcbmNvbnN0IHNlYXJjaEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWFyY2gnKTtcclxuY29uc3QgdW5pdHNDbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdW5pdHMnKTtcclxuXHJcbi8vIGRlZmF1bHRcclxubGV0IHVuaXRzRm9ybWF0ICA9IE1FVFJJQztcclxuXHJcbi8vIGEgYml0IG9mIGV2ZW50IGRlbGVnYXRpb25cclxudW5pdHNDbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXYpID0+IHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBjb25zdCBub2RlTmFtZSA9IGV2LnRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG5cclxuICAgIGlmIChub2RlTmFtZSA9PT0gJ2lucHV0Jykge1xyXG4gICAgICAgIHVuaXRzRm9ybWF0ID0gZXYudGFyZ2V0LnZhbHVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdW5pdHNGb3JtYXQgPSBldi50YXJnZXQuY29udHJvbC52YWx1ZTtcclxuICAgIH1cclxufSk7XHJcblxyXG4vLyBsaXN0ZW5zIGZvciB1c2VyJ3Mga2VwcmVzc2VzLCBhbmQgcGFzc2VzIGRhdGEgdG8gY29udHJvbGxlclxyXG5zZWFyY2hUZXh0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCAoZXYpID0+IHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICAvLyBvbmx5IG9uIGVudGVyXHJcbiAgICBpZiAoZXYua2V5Q29kZSA9PT0gMTMpIHtcclxuXHJcbiAgICAgICAgLy8gaWYgY2FsbGJhY2sgaXMgY29uZmlndXJlZFxyXG4gICAgICAgIGlmIChhcHBFdmVudEhhbmRsZXJzLm9uU2VhcmNoICYmIHNlYXJjaFRleHRJbnB1dC52YWx1ZSkge1xyXG4gICAgICAgICAgICBhcHBFdmVudEhhbmRsZXJzLm9uU2VhcmNoKHNlYXJjaFRleHRJbnB1dC52YWx1ZSwgdW5pdHNGb3JtYXQpO1xyXG5cclxuICAgICAgICAgICAgLy8gcmVzZXQgdGhlIHNlYXJjaCBpbnB1dFxyXG4gICAgICAgICAgICBzZWFyY2hUZXh0SW5wdXQudmFsdWUgPSAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuLy8gbGlzdGVucyBmb3IgdXNlcidzIGNsaWNrcywgYW5kIHBhc3NlcyBkYXRhIHRvIGNvbnRyb2xsZXJcclxuc2VhcmNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIC8vIGlmIGNhbGxiYWNrIGlzIGNvbmZpZ3VyZWRcclxuICAgIGlmIChhcHBFdmVudEhhbmRsZXJzLm9uU2VhcmNoICYmIHNlYXJjaFRleHRJbnB1dC52YWx1ZSkge1xyXG4gICAgICAgIGFwcEV2ZW50SGFuZGxlcnMub25TZWFyY2goc2VhcmNoVGV4dElucHV0LnZhbHVlLCB1bml0c0Zvcm1hdCk7XHJcblxyXG4gICAgICAgIC8vIHJlc2V0IHRoZSBzZWFyY2ggaW5wdXRcclxuICAgICAgICBzZWFyY2hUZXh0SW5wdXQudmFsdWUgPSAnJztcclxuICAgIH1cclxufSk7XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9hcHAvYXBwLnZpZXdzLmpzXG4gKiovIiwiaW1wb3J0IHtJTVBFUklBTH0gZnJvbSAnLi4vY29uc3RhbnRzLmpzJztcclxuXHJcbmNvbnN0IGZvcmVjYXN0Q250ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcmVjYXN0Jyk7XHJcbmNvbnN0IGNpdHlDbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9yZWNhc3QgLmNpdHknKTtcclxuY29uc3QgcmFpbkNudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yYWluID4gc3BhbicpO1xyXG5jb25zdCB0ZW1wQ250ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlbXAgPiBzcGFuJyk7XHJcbmNvbnN0IHByZXNDbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJlcyA+IHNwYW4nKTtcclxuY29uc3QgY2xvdWRzQ250ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsb3VkcyA+IHNwYW4nKTtcclxuY29uc3QgZGF0ZUNudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50aW1lID4gaDInKTtcclxuY29uc3QgdGltZUNudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50aW1lID4gaDMnKTtcclxuY29uc3QgbmV4dEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hY3Rpb25zID4gLm5leHQnKTtcclxuY29uc3QgcHJldkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hY3Rpb25zID4gLnByZXYnKTtcclxuXHJcbmV4cG9ydCBsZXQgdmlld1N0YXRlID0ge1xyXG4gICAgbmV4dDogdHJ1ZSxcclxuICAgIHByZXY6IHRydWUsXHJcbiAgICBsb2FkaW5nOiB0cnVlXHJcbn07XHJcblxyXG5leHBvcnQgbGV0IGZvcmVjYXN0RXZlbnRIYW5kbGVycyA9IHtcclxuICAgIG9uTmV4dDogbnVsbCxcclxuICAgIG9uUHJldjogbnVsbFxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFJlbmRlcnMgdmFsdXNlIGludG8gdGhlIGh0bWwgdXNpbmcgaHRtbCB0ZW1wbGF0ZSBzdHJpbmdzLlxyXG4gKiBcclxuICogQHBhcmFtICB7T2JqZWN0fSBvcHRpb25zLnJlc3BvbnNlICAgIHRoZSByZXNwb25zZSBvYmplY3QgZm9yIGEgc2luZ2xlIGZvcmVjYXN0XHJcbiAqIEBwYXJhbSAge09iamVjdH0gb3B0aW9ucy5wYXJhbXMgICAgICB0aGVlIHF1ZXJ5IHBhcmFtZXRlcnNcclxuICogQHJldHVybiB7dW5kZWZpbmVkfVxyXG4gKi9cclxuZnVuY3Rpb24gcmVuZGVyKHtyZXNwb25zZSwgcGFyYW1zfSkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNvbnN0IHtuYW1lLCBjb3VudHJ5fSA9IHJlc3BvbnNlLmNpdHk7XHJcbiAgICBjb25zdCB7cmFpbiwgbWFpbiwgY2xvdWRzLCBkdH0gPSByZXNwb25zZS5zaW5nbGVGb3JlY2FzdDtcclxuXHJcbiAgICAvLyBjb252ZXJ0IFVOSVggdGltZXN0YW1wIHRvIG1pbGxpc2Vjb25kc1xyXG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGR0KjEwMDApO1xyXG4gICAgY29uc3QgeWVhciA9IGRhdGUuZ2V0VVRDRnVsbFllYXIoKTtcclxuXHJcbiAgICAvLyBwYXJzaW5nIGRhdGUgLSB1Z2hcclxuICAgIGxldCBkYXkgPSBkYXRlLmdldFVUQ0RhdGUoKTtcclxuICAgIGRheSA9IGRheSA8IDEwID8gYDAke2RheX1gIDogZGF5O1xyXG5cclxuICAgIGxldCBtb250aCA9IGRhdGUuZ2V0VVRDTW9udGgoKSArIDE7XHJcbiAgICBtb250aCA9IG1vbnRoIDwgMTAgPyBgMCR7bW9udGh9YCA6IG1vbnRoO1xyXG5cclxuICAgIGxldCBob3VycyA9IGRhdGUuZ2V0VVRDSG91cnMoKTtcclxuICAgIGhvdXJzID0gaG91cnMgPCAxMCA/IGAwJHtob3Vyc31gIDogaG91cnM7XHJcblxyXG4gICAgbGV0IG1pbnV0ZXMgPSBkYXRlLmdldFVUQ01pbnV0ZXMoKTtcclxuICAgIG1pbnV0ZXMgPSBtaW51dGVzIDwgMTAgPyBgMCR7bWludXRlc31gIDogbWludXRlcztcclxuXHJcbiAgICBsZXQgc2Vjb25kcyA9IGRhdGUuZ2V0VVRDU2Vjb25kcygpO1xyXG4gICAgc2Vjb25kcyA9IHNlY29uZHMgPCAxMCA/IGAwJHtzZWNvbmRzfWAgOiBzZWNvbmRzO1xyXG5cclxuICAgIC8vIG5vIG9wdGltaXplZFxyXG4gICAgLy8gVE9ETyBkaWZmIGNvbnRlbnQsIGFuZCBvbmx5IG92ZXJ3cml0ZSB3aGVyZSB0aGVyZSdzIGEgY2hhbmdlXHJcbiAgICBjaXR5Q250LmlubmVySFRNTCA9IGAke25hbWV9LCAke2NvdW50cnl9YDtcclxuICAgIHJhaW5DbnQuaW5uZXJIVE1MID0gYCR7cmFpbiAmJiByYWluWyczaCddIHx8IDB9IG1tYDtcclxuICAgIHRlbXBDbnQuaW5uZXJIVE1MID0gYCR7TWF0aC5yb3VuZChtYWluLnRlbXApfSR7KHBhcmFtcy51bml0cyA9PT0gSU1QRVJJQUwgPyAnJmRlZztGJyA6ICcmZGVnO0MnKX1gO1xyXG4gICAgcHJlc0NudC5pbm5lckhUTUwgPSBgJHtNYXRoLnJvdW5kKG1haW4ucHJlc3N1cmUpfSBoUGFgO1xyXG4gICAgY2xvdWRzQ250LmlubmVySFRNTCA9IGAke2Nsb3Vkcy5hbGx9JWA7XHJcbiAgICBkYXRlQ250LmlubmVySFRNTCA9IGAke2RheX0vJHttb250aH0vJHt5ZWFyfWA7XHJcbiAgICB0aW1lQ250LmlubmVySFRNTCA9IGAke2hvdXJzfToke21pbnV0ZXN9OiR7c2Vjb25kc31gO1xyXG5cclxuICAgIC8vIG5vdCBvcHRpbWl6ZWRcclxuICAgIC8vIGFjdGlvbnMgYXMgYWJvdmVcclxuICAgIG5leHRCdXR0b24uZGlzYWJsZWQgPSB2aWV3U3RhdGUubmV4dCA/IGZhbHNlIDogdHJ1ZTtcclxuICAgIHByZXZCdXR0b24uZGlzYWJsZWQgPSB2aWV3U3RhdGUucHJldiA/IGZhbHNlIDogdHJ1ZTtcclxuXHJcbiAgICB2aWV3U3RhdGUubG9hZGluZyA/IFxyXG4gICAgICAgIGZvcmVjYXN0Q250LmNsYXNzTmFtZSArPSAnIGxvYWRpbmcnIDogXHJcbiAgICAgICAgZm9yZWNhc3RDbnQuY2xhc3NOYW1lID0gZm9yZWNhc3RDbnQuY2xhc3NOYW1lLnJlcGxhY2UoL1xcc2xvYWRpbmcvLCAnJyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBbdXBkYXRlRm9yZWNhc3QgZGVzY3JpcHRpb25dXHJcbiAqIEBwYXJhbSAge1t0eXBlXX0gZm9yZWNhc3REYXRhIFtkZXNjcmlwdGlvbl1cclxuICogQHJldHVybiB7W3R5cGVdfSAgICAgICAgICAgICAgW2Rlc2NyaXB0aW9uXVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUZvcmVjYXN0KGZvcmVjYXN0RGF0YSkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgcmVuZGVyKGZvcmVjYXN0RGF0YSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBbZ2V0TmV4dERhdGEgZGVzY3JpcHRpb25dXHJcbiAqIEBwYXJhbSAge1t0eXBlXX0gbmV4dERhdGEgW2Rlc2NyaXB0aW9uXVxyXG4gKiBAcmV0dXJuIHtbdHlwZV19ICAgICAgICAgIFtkZXNjcmlwdGlvbl1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXROZXh0RGF0YShuZXh0RGF0YSkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgcmVuZGVyKG5leHREYXRhKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFtnZXRQcmV2RGF0YSBkZXNjcmlwdGlvbl1cclxuICogQHBhcmFtICB7W3R5cGVdfSBwcmV2RGF0YSBbZGVzY3JpcHRpb25dXHJcbiAqIEByZXR1cm4ge1t0eXBlXX0gICAgICAgICAgW2Rlc2NyaXB0aW9uXVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFByZXZEYXRhKHByZXZEYXRhKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICByZW5kZXIocHJldkRhdGEpO1xyXG59XHJcbiBcclxubmV4dEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICAvLyBpZiBjYWxsYmFjayBpcyBjb25maWd1cmVkXHJcbiAgICBpZiAoZm9yZWNhc3RFdmVudEhhbmRsZXJzLm9uTmV4dCkge1xyXG4gICAgICAgIGZvcmVjYXN0RXZlbnRIYW5kbGVycy5vbk5leHQoKTtcclxuICAgIH1cclxufSk7XHJcblxyXG5wcmV2QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIC8vIGlmIGNhbGxiYWNrIGlzIGNvbmZpZ3VyZWRcclxuICAgIGlmIChmb3JlY2FzdEV2ZW50SGFuZGxlcnMub25QcmV2KSB7XHJcbiAgICAgICAgZm9yZWNhc3RFdmVudEhhbmRsZXJzLm9uUHJldigpO1xyXG4gICAgfVxyXG59KTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL2FwcC9mb3JlY2FzdC9mb3JlY2FzdC52aWV3cy5qc1xuICoqLyJdLCJzb3VyY2VSb290IjoiIn0=